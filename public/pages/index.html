<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8">
		<title>CSC 370 Project</title>

		<!-- CSS  -->
		<!-- load bootstrap from CDN and custom CSS -->
		<link rel="stylesheet" type="text/css" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
		<link rel="stylesheet" href="/styles/style.css">

		
		<!-- JS -->
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="/scripts/main.js"></script>


	</head>

	<body>
	
	
	<!-- HEADER -->

	<div class="page-header" style="margin-bottom:0px;">
		<h1>Front Page  <small>Top Posts in Default Subsaiddits</small></h1>
	</div>
	<!-- HEADER -->
	
	<!-- NAVBAR -->
	<nav class="navbar navbar-inverse">
	  <div class="container-fluid">
		<!-- Brand and toggle get grouped for better mobile display -->
		<div class="navbar-header">
		  <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
			<span class="sr-only">Toggle navigation</span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
			<span class="icon-bar"></span>
		  </button>
		 
		  <a class="navbar-brand" href="#"><img src="../images/logo_2.png"></a>
		</div>

		<!-- Collect the nav links, forms, and other content for toggling -->
		<div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
		  <ul class="nav navbar-nav">
		  
			<li class="active"><a href="index.html">Front Page<span class="sr-only">(current)</span></a></li>
			
			<li ><a href="/pages/template.html">Template</a></li>
			
			<li class="dropdown">
			  <a href="" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Other <span class="caret"></span></a>
			  <ul class="dropdown-menu">
				<li><a href="">Front Page (Logged In)</a></li>
				<li role="separator" class="divider"></li>
				<li><a href="">Populate Tables</a></li>
				<li role="separator" class="divider"></li>
				<li><a href="">Delete a Post</a></li>
			  </ul>
			</li>
			
		  </ul>
			
			<form id="login_frm" class="navbar-form navbar-right">
			<div class="form-group">
			  <input type="text" class="form-control" placeholder="User" name="user">
				<input type="password" class="form-control" placeholder="Pass" name="pass">
			</div>
			<button class="btn btn-default" type="button" onclick="login()">Login</button>
		  </form>
			
			<script>
			function login(){
	
				var form = $('#login_frm');
				var user_input = form.find("input[name='user']");
				var pass_input = form.find("input[name='pass']");
				var loginData = {
					user:user_input.val(),
					pass:pass_input.val()
				};
				
				console.log(loginData);
				console.log(JSON.stringify(loginData));

				$.ajax({
					url: "/login",
					type: "POST",
					data: loginData,
					success: isError
				});
				
				user_input.val("");
				pass_input.val("");
				
				
	
			}
			
			
			
			
			function isError(data){
			
				if(data.error){
					alert("Incorrect Login")
				}
					
				else{
					alert("Successful Login!")
				}
				
			
			
			}
			</script>
			
			
			<!--
		  <form class="navbar-form navbar-right" role="search">
			<div class="form-group">
			  <input type="text" class="form-control" placeholder="Search">
			</div>
			<button type="submit" class="btn btn-default">Submit</button>
		  </form>
			-->
			
		</div><!-- /.navbar-collapse -->
	  </div><!-- /.container-fluid -->
	</nav>
	<!-- END OF NAVBAR -->
	
	
	<!-- CONTENT -->
	<div class="container content-view">
	  <div class="row">
	  
		<!-- LEFT SIDEBAR -->
		<div class="col-sm-2">
		
		</div>
		<!-- END OF LEFT SIDEBAR -->
		
		
		<!-- CENTRE AREA -->
		<div class="col-sm-8">
		
		<!-- EXAMPLE PANEL 4 -->
		
		<div class="panel panel-default" id="defaultSubs">
			<div class="panel-heading">
				<h3 class="panel-title">Default Subsaiddits <span id="numDefSubs" class="badge">2</span></h3>
			</div>
				
			<!-- Table -->
			<table class="table">
			
			</table>
		</div>
		<!-- END OF EXAMPLE PANEL 4 -->
		
		<!-- EXAMPLE PANEL 1 -->
		<div class="panel panel-default">
		  <div class="panel-heading">
			<h2 class="panel-title"><span class="badge pull-left" style="margin-right: 10px">4505</span>
			This is an Awesome Post!! <a class="pull-right" href="http://reddit.com">http://reddit.com</a>	
		
			</div>
			
		  <div class="panel-body">
			
			<div class="well well-sm" style="margin-bottom:0px">
				Lorem ipsum dolor sit amet, consectetur adipiscing elit. 
				Donec justo augue, tempor sed vehicula quis, malesuada vel odio. 
				Praesent vel blandit mauris. Aliquam dictum erat nec ligula ultricies, 
				eu varius urna ornare. Donec fringilla nulla felis, et aliquam nulla 
				convallis quis.
			</div>
			<h5 class="pull-left"> 
			<span class="label label-default">id: 0</span>
			<span class="label label-default">Sun Jun 26 02:33:20 2016 GMT</span>
			<span class="label label-default">admin</span>
			</h5>
		


		</div>
		<!-- END OF EXAMPLE PANEL 1 -->

		
		
		
		<script>
			//add rows of data to example table using JS on page load
			$(document).ready(function(){
				
				getDefSubs();
			
			});
			
			
		function getDefSubs(){
		
		 var header = "";
		
			//get request to server: /s
			$.ajax({
					url: "/s",
					type: "GET",
					success: function(data){
					
						alert("success!!!!!");
						data = JSON.parse(data);
						console.log(data);
						
						if(data.length == 0){
						}else{
							header = Object.keys(data[0]);
							console.log(header);
							$("#numDefSubs").text(data.length);
						}
						
						var tableData = [header]
						
						row = [];
						for(var i=0; i < data.length; i++){
							row.push(data[i].title);
							row.push(data[i].description);
							row.push(data[i].creator);
							tableData.push(row);
							row = [];
						}
						
						makeTable($("#defaultSubs"), tableData);
					
					}, 
					error: function(data) {
							alert('woops!'); //or whatever
					}
			});
		}
			
			function makeTable(container, data) {
				var table = $("table").addClass('CSSTableGenerator');
				$.each(data, function(rowIndex, r) {
					var row = $("<tr/>");
					$.each(r, function(colIndex, c) { 
						row.append($("<t"+(rowIndex == 0 ?  "h" : "d")+"/>").text(c));
					});
					table.append(row);
				});
				return container.append(table);
			}
			
			
		</script>
		

		</div>
		<!-- END OF CENTRE AREA -->
		
		<!-- RIGHT SIDEBAR -->
		<div class="col-sm-2">
		  
		</div>
		<!-- END OF RIGHT SIDEBAR -->
		
	  </div>
	</div>
	
	

	
	</body>
</html>
